"use strict";(globalThis.webpackChunkcortex_h1=globalThis.webpackChunkcortex_h1||[]).push([[95],{6991:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>m,frontMatter:()=>t,metadata:()=>a,toc:()=>o});const a=JSON.parse('{"id":"module-3-ai-brain/policy-gradients","title":"3.4 Lab: PPO for Continuous Control","description":"Using PPO to balance an inverted pendulum (Continuous Action).","source":"@site/docs/module-3-ai-brain/04-policy-gradients.md","sourceDirName":"module-3-ai-brain","slug":"/module-3-ai-brain/policy-gradients","permalink":"/Cortex-H1/docs/module-3-ai-brain/policy-gradients","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/module-3-ai-brain/04-policy-gradients.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"id":"policy-gradients","title":"3.4 Lab: PPO for Continuous Control","sidebar_label":"3.4 Lab: PPO","description":"Using PPO to balance an inverted pendulum (Continuous Action)."},"sidebar":"textbookSidebar","previous":{"title":"3.3 Lab: DQN","permalink":"/Cortex-H1/docs/module-3-ai-brain/q-learning"},"next":{"title":"3.5 Model-Based RL","permalink":"/Cortex-H1/docs/module-3-ai-brain/model-based-rl"}}');var i=s(4848),l=s(8453);const t={id:"policy-gradients",title:"3.4 Lab: PPO for Continuous Control",sidebar_label:"3.4 Lab: PPO",description:"Using PPO to balance an inverted pendulum (Continuous Action)."},r="3.4 Lab: PPO for Continuous Control",c={},o=[{value:"\ud83c\udfaf Lab Objectives",id:"-lab-objectives",level:2},{value:"3.4.1 The Environment: Pendulum-v1",id:"341-the-environment-pendulum-v1",level:2},{value:"3.4.2 The Code",id:"342-the-code",level:2},{value:"3.4.3 Parallel Training (<code>make_vec_env</code>)",id:"343-parallel-training-make_vec_env",level:2},{value:"3.4.4 Quiz",id:"344-quiz",level:2}];function d(e){const n={annotation:"annotation",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",math:"math",mi:"mi",mn:"mn",mo:"mo",mover:"mover",mrow:"mrow",ol:"ol",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"34-lab-ppo-for-continuous-control",children:"3.4 Lab: PPO for Continuous Control"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:'"Torque is continuous."'})}),"\n",(0,i.jsxs)(n.p,{children:["DQN only works for discrete buttons (Left/Right). Robots have motors that accept continuous values (e.g., -5.0 Nm to +5.0 Nm). For this, we need ",(0,i.jsx)(n.strong,{children:"PPO (Proximal Policy Optimization)"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"-lab-objectives",children:"\ud83c\udfaf Lab Objectives"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Understand Continuous Action Spaces"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Train PPO"})," on ",(0,i.jsx)(n.code,{children:"Pendulum-v1"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Tune Hyperparameters"})," (Learning Rate)."]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"341-the-environment-pendulum-v1",children:"3.4.1 The Environment: Pendulum-v1"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Goal"}),": Swing up a pendulum and keep it upright."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Action"}),": Torque ",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"a"}),(0,i.jsx)(n.mi,{children:"u"}),(0,i.jsx)(n.mo,{children:"\u2208"}),(0,i.jsx)(n.mo,{stretchy:"false",children:"["}),(0,i.jsx)(n.mo,{children:"\u2212"}),(0,i.jsx)(n.mn,{children:"2.0"}),(0,i.jsx)(n.mo,{separator:"true",children:","}),(0,i.jsx)(n.mn,{children:"2.0"}),(0,i.jsx)(n.mo,{stretchy:"false",children:"]"})]}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"\tau \\in [-2.0, 2.0]"})]})})}),(0,i.jsxs)(n.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.5782em",verticalAlign:"-0.0391em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"a"}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"u"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(n.span,{className:"mrel",children:"\u2208"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(n.span,{className:"mopen",children:"["}),(0,i.jsx)(n.span,{className:"mord",children:"\u2212"}),(0,i.jsx)(n.span,{className:"mord",children:"2.0"}),(0,i.jsx)(n.span,{className:"mpunct",children:","}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(n.span,{className:"mord",children:"2.0"}),(0,i.jsx)(n.span,{className:"mclose",children:"]"})]})]})]}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Observation"}),": [cos",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsx)(n.mrow,{children:(0,i.jsx)(n.mi,{children:"\u03b8"})}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"\\theta"})]})})}),(0,i.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.6944em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"\u03b8"})]})})]}),", sin",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsx)(n.mrow,{children:(0,i.jsx)(n.mi,{children:"\u03b8"})}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"\\theta"})]})})}),(0,i.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.6944em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"\u03b8"})]})})]}),", ",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsx)(n.mrow,{children:(0,i.jsxs)(n.mover,{accent:"true",children:[(0,i.jsx)(n.mi,{children:"\u03b8"}),(0,i.jsx)(n.mo,{children:"\u02d9"})]})}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"\\dot{\\theta}"})]})})}),(0,i.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.9313em"}}),(0,i.jsx)(n.span,{className:"mord accent",children:(0,i.jsx)(n.span,{className:"vlist-t",children:(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsxs)(n.span,{className:"vlist",style:{height:"0.9313em"},children:[(0,i.jsxs)(n.span,{style:{top:"-3em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"\u03b8"})]}),(0,i.jsxs)(n.span,{style:{top:"-3.2634em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(n.span,{className:"accent-body",style:{left:"-0.0556em"},children:(0,i.jsx)(n.span,{className:"mord",children:"\u02d9"})})]})]})})})})]})})]}),"]."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"342-the-code",children:"3.4.2 The Code"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'import gymnasium as gym\nfrom stable_baselines3 import PPO\nfrom stable_baselines3.common.env_util import make_vec_env\n\n# 1. Vectorized Environment (Run 4 sims in parallel!)\nenv = make_vec_env("Pendulum-v1", n_envs=4)\n\n# 2. Define PPO\nmodel = PPO(\n    "MlpPolicy", \n    env, \n    verbose=1, \n    learning_rate=0.0003,\n    n_steps=2048,\n    batch_size=64,\n    n_epochs=10\n)\n\n# 3. Train\nmodel.learn(total_timesteps=100000)\nmodel.save("ppo_pendulum")\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h2,{id:"343-parallel-training-make_vec_env",children:["3.4.3 Parallel Training (",(0,i.jsx)(n.code,{children:"make_vec_env"}),")"]}),"\n",(0,i.jsx)(n.p,{children:'PPO is "On-Policy". It needs fresh data constantly.\nRunning 4 environments in parallel speeds up data collection by 4x. This is crucial for robotics.'}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"344-quiz",children:"3.4.4 Quiz"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Can DQN solve Pendulum-v1?"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"a) Yes, easily."}),"\n",(0,i.jsx)(n.li,{children:"b) No, because DQN requires discrete actions. You would have to discretize the torque."}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.em,{children:"Answer: b"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.strong,{children:["Why use ",(0,i.jsx)(n.code,{children:"make_vec_env"}),"?"]})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"a) To make the code look complex."}),"\n",(0,i.jsx)(n.li,{children:"b) To collect experience from multiple simulations simultaneously, stabilizing the gradient."}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.em,{children:"Answer: b"})}),"\n"]}),"\n"]}),"\n"]})]})}function m(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>r});var a=s(6540);const i={},l=a.createContext(i);function t(e){const n=a.useContext(l);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),a.createElement(l.Provider,{value:n},e.children)}}}]);