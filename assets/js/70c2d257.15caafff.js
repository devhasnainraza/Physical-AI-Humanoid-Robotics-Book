"use strict";(globalThis.webpackChunkcortex_h1=globalThis.webpackChunkcortex_h1||[]).push([[6911],{1094:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>l,metadata:()=>o,toc:()=>a});const o=JSON.parse('{"id":"module-1-ros2/control-systems","title":"1.4 ROS 2 Control","description":"Implementing PID and ros2_control framework.","source":"@site/docs/module-1-ros2/04-control-systems.md","sourceDirName":"module-1-ros2","slug":"/module-1-ros2/control-systems","permalink":"/Cortex-H1/docs/module-1-ros2/control-systems","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/module-1-ros2/04-control-systems.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"id":"control-systems","title":"1.4 ROS 2 Control","sidebar_label":"1.4 Control","description":"Implementing PID and ros2_control framework."},"sidebar":"textbookSidebar","previous":{"title":"1.3 Kinematics (URDF)","permalink":"/Cortex-H1/docs/module-1-ros2/kinematics-dynamics"},"next":{"title":"1.5 Sensor Fusion","permalink":"/Cortex-H1/docs/module-1-ros2/perception-sensor-fusion"}}');var t=r(4848),s=r(8453);const l={id:"control-systems",title:"1.4 ROS 2 Control",sidebar_label:"1.4 Control",description:"Implementing PID and ros2_control framework."},i="1.4 ROS 2 Control Framework",c={},a=[{value:"\ud83c\udfaf Lab Objectives",id:"-lab-objectives",level:2},{value:"1.4.1 The Architecture",id:"141-the-architecture",level:2},{value:"1.4.2 Lab: Add Control to URDF",id:"142-lab-add-control-to-urdf",level:2},{value:"1.4.3 Lab: Configuration (<code>controllers.yaml</code>)",id:"143-lab-configuration-controllersyaml",level:2},{value:"1.4.4 Sending a Command",id:"144-sending-a-command",level:2},{value:"1.4.5 Quiz",id:"145-quiz",level:2}];function d(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"14-ros-2-control-framework",children:"1.4 ROS 2 Control Framework"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:'"Don\'t write your own PID loop. Use the standard."'})}),"\n",(0,t.jsxs)(n.p,{children:["In this lab, we will use ",(0,t.jsx)(n.code,{children:"ros2_control"}),", the industrial standard for controlling robots in ROS 2. It handles the timing, resource management, and controller switching for you."]}),"\n",(0,t.jsx)(n.h2,{id:"-lab-objectives",children:"\ud83c\udfaf Lab Objectives"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsxs)(n.strong,{children:["Configure ",(0,t.jsx)(n.code,{children:"ros2_control"})]})," in URDF."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Spawn a Joint Trajectory Controller"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Command the robot"})," to move."]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"141-the-architecture",children:"1.4.1 The Architecture"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Controller Manager"}),": The boss. Loads/Unloads controllers."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Hardware Interface"}),": The driver (reads from ",(0,t.jsx)(n.code,{children:"read()"}),", writes to ",(0,t.jsx)(n.code,{children:"write()"}),")."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Controllers"}),":","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"joint_trajectory_controller"}),": Follows a path (smooth)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"velocity_controller"}),": Spins wheels."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"effort_controller"}),": Sends raw torque."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"142-lab-add-control-to-urdf",children:"1.4.2 Lab: Add Control to URDF"}),"\n",(0,t.jsxs)(n.p,{children:["Add this to your ",(0,t.jsx)(n.code,{children:"my_robot.urdf"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:'<ros2_control name="RealRobot" type="system">\n  <hardware>\n    <plugin>mock_components/GenericSystem</plugin> \x3c!-- Simulates hardware --\x3e\n  </hardware>\n  <joint name="base_to_arm">\n    <command_interface name="position"/>\n    <state_interface name="position"/>\n    <state_interface name="velocity"/>\n  </joint>\n</ros2_control>\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h2,{id:"143-lab-configuration-controllersyaml",children:["1.4.3 Lab: Configuration (",(0,t.jsx)(n.code,{children:"controllers.yaml"}),")"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"controller_manager:\n  ros__parameters:\n    update_rate: 100  # Hz\n    joint_trajectory_controller:\n      type: joint_trajectory_controller/JointTrajectoryController\n    joint_state_broadcaster:\n      type: joint_state_broadcaster/JointStateBroadcaster\n\njoint_trajectory_controller:\n  ros__parameters:\n    joints:\n      - base_to_arm\n    interface_name: position\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"144-sending-a-command",children:"1.4.4 Sending a Command"}),"\n",(0,t.jsx)(n.p,{children:"Once launched, you can move the robot by publishing a trajectory:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"ros2 topic pub /joint_trajectory_controller/joint_trajectory trajectory_msgs/msg/JointTrajectory '{joint_names: [\"base_to_arm\"], points: [{positions: [1.0], time_from_start: {sec: 1, nanosec: 0}}]}' -1\n"})}),"\n",(0,t.jsx)(n.p,{children:"The arm will smoothly interpolate to 1.0 radian over 1 second."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"145-quiz",children:"1.4.5 Quiz"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsxs)(n.strong,{children:["What is the role of the ",(0,t.jsx)(n.code,{children:"hardware_interface"}),"?"]})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"a) To run the PID loop."}),"\n",(0,t.jsx)(n.li,{children:"b) To abstract the physical hardware (read/write) from the controllers."}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.em,{children:"Answer: b"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsxs)(n.strong,{children:["Why use ",(0,t.jsx)(n.code,{children:"joint_trajectory_controller"})," instead of raw position commands?"]})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"a) It ensures smooth motion (velocity/acceleration limits)."}),"\n",(0,t.jsx)(n.li,{children:"b) It is faster."}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.em,{children:"Answer: a"})}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>i});var o=r(6540);const t={},s=o.createContext(t);function l(e){const n=o.useContext(s);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);