"use strict";(globalThis.webpackChunktemp_docusaurus=globalThis.webpackChunktemp_docusaurus||[]).push([[662],{8057:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>c,frontMatter:()=>r,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"module-4-vla/fine-tuning-llms","title":"Fine-Tuning LLMs for Robotics","description":"1. Why GPT-4 is Not Enough","source":"@site/docs/module-4-vla/05-fine-tuning-llms.md","sourceDirName":"module-4-vla","slug":"/module-4-vla/fine-tuning-llms","permalink":"/Cortex-H1/docs/module-4-vla/fine-tuning-llms","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/module-4-vla/05-fine-tuning-llms.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5,"title":"Fine-Tuning LLMs for Robotics"},"sidebar":"textbookSidebar","previous":{"title":"Capstone: The Butler Robot","permalink":"/Cortex-H1/docs/module-4-vla/capstone-project"},"next":{"title":"Robotic Transformers (RT-1, RT-2)","permalink":"/Cortex-H1/docs/module-4-vla/robot-transformers"}}');var s=t(4848),a=t(8453);const r={sidebar_position:5,title:"Fine-Tuning LLMs for Robotics"},i='Creating a "Robot Brain" Model',l={},d=[{value:"1. Why GPT-4 is Not Enough",id:"1-why-gpt-4-is-not-enough",level:2},{value:"2. LoRA (Low-Rank Adaptation)",id:"2-lora-low-rank-adaptation",level:2},{value:"2.1 The Dataset",id:"21-the-dataset",level:3},{value:"2.2 Training Code (Unsloth)",id:"22-training-code-unsloth",level:3}];function u(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"creating-a-robot-brain-model",children:'Creating a "Robot Brain" Model'})}),"\n",(0,s.jsx)(n.h2,{id:"1-why-gpt-4-is-not-enough",children:"1. Why GPT-4 is Not Enough"}),"\n",(0,s.jsxs)(n.p,{children:["General LLMs are too chatty.\n",(0,s.jsx)(n.strong,{children:"User"}),': "Pick up the cup."\n',(0,s.jsx)(n.strong,{children:"GPT-4"}),': "Certainly! I would be happy to help you with that task. Picking up a cup involves..."\n',(0,s.jsx)(n.strong,{children:"Robot"}),": ",(0,s.jsx)(n.em,{children:"Crashes because it expected JSON."})]}),"\n",(0,s.jsxs)(n.p,{children:["We need to ",(0,s.jsx)(n.strong,{children:"Fine-Tune"})," a model to be terse and structural."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"2-lora-low-rank-adaptation",children:"2. LoRA (Low-Rank Adaptation)"}),"\n",(0,s.jsxs)(n.p,{children:["Full fine-tuning of Llama 3 (8B params) requires massive VRAM.\n",(0,s.jsx)(n.strong,{children:"LoRA"})," freezes the main weights and trains only a tiny adapter layer (1% of params).\nYou can train a robot controller on a single consumer GPU (RTX 4090)."]}),"\n",(0,s.jsx)(n.h3,{id:"21-the-dataset",children:"2.1 The Dataset"}),"\n",(0,s.jsx)(n.p,{children:"Input-Output pairs:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{"input": "Grab the red block", "output": "PICK(block_red)"}\n{"input": "Move to kitchen", "output": "NAV(kitchen)"}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"22-training-code-unsloth",children:"2.2 Training Code (Unsloth)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'from unsloth import FastLanguageModel\n\nmodel, tokenizer = FastLanguageModel.from_pretrained(\n    model_name = "unsloth/llama-3-8b-bnb-4bit",\n    max_seq_length = 2048,\n    load_in_4bit = True,\n)\n\n# Train on 1000 examples...\n'})}),"\n",(0,s.jsx)(n.p,{children:'The result is a model that speaks "Robot" fluently.'})]})}function c(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>i});var o=t(6540);const s={},a=o.createContext(s);function r(e){const n=o.useContext(a);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),o.createElement(a.Provider,{value:n},e.children)}}}]);