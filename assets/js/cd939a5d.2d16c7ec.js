"use strict";(globalThis.webpackChunkcortex_h1=globalThis.webpackChunkcortex_h1||[]).push([[9599],{4028:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"module-3-ai-brain/intro-rl","title":"3.1 Lab: The RL Stack","description":"Setting up PyTorch, Gym, and Stable Baselines 3.","source":"@site/docs/module-3-ai-brain/01-intro-rl.md","sourceDirName":"module-3-ai-brain","slug":"/module-3-ai-brain/intro-rl","permalink":"/Cortex-H1/docs/module-3-ai-brain/intro-rl","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/module-3-ai-brain/01-intro-rl.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"id":"intro-rl","title":"3.1 Lab: The RL Stack","sidebar_label":"3.1 Lab: Setup","description":"Setting up PyTorch, Gym, and Stable Baselines 3."},"sidebar":"textbookSidebar","previous":{"title":"05. NVIDIA Isaac Lab","permalink":"/Cortex-H1/docs/module-2-digital-twin/isaac-lab"},"next":{"title":"3.2 Lab: Custom Env","permalink":"/Cortex-H1/docs/module-3-ai-brain/mdp"}}');var i=t(4848),a=t(8453);const s={id:"intro-rl",title:"3.1 Lab: The RL Stack",sidebar_label:"3.1 Lab: Setup",description:"Setting up PyTorch, Gym, and Stable Baselines 3."},l="3.1 Lab: The RL Stack",o={},d=[{value:"\ud83c\udfaf Lab Objectives",id:"-lab-objectives",level:2},{value:"3.1.1 Installation",id:"311-installation",level:2},{value:"3.1.2 The &quot;Hello World&quot; of RL",id:"312-the-hello-world-of-rl",level:2},{value:"Code: The Random Agent",id:"code-the-random-agent",level:3},{value:"3.1.3 Understanding the Observation",id:"313-understanding-the-observation",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"31-lab-the-rl-stack",children:"3.1 Lab: The RL Stack"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:'"Before we learn, we must install."'})}),"\n",(0,i.jsxs)(n.p,{children:["In this lab, we prepare the deep learning environment required to train intelligent agents. We will use ",(0,i.jsx)(n.strong,{children:"Stable Baselines 3 (SB3)"}),", the industry standard for reliable RL implementations."]}),"\n",(0,i.jsx)(n.h2,{id:"-lab-objectives",children:"\ud83c\udfaf Lab Objectives"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:'Install the "God Stack"'}),": PyTorch + Gym + SB3."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Verify GPU Acceleration"})," (CUDA)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Run a Baseline"}),": Random Agent."]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"311-installation",children:"3.1.1 Installation"}),"\n",(0,i.jsx)(n.p,{children:"Create a fresh Conda environment to avoid dependency hell."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"conda create -n ai_brain python=3.10\nconda activate ai_brain\n\n# 1. PyTorch (Check pytorch.org for your CUDA version)\npip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118\n\n# 2. RL Libraries\npip install gymnasium[all] stable-baselines3 shimmy\npip install tensorboard\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"312-the-hello-world-of-rl",children:'3.1.2 The "Hello World" of RL'}),"\n",(0,i.jsxs)(n.p,{children:["Let's run the classic ",(0,i.jsx)(n.strong,{children:"CartPole"})," environment."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Goal"}),": Balance a pole on a cart."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Input"}),": ",(0,i.jsx)(n.code,{children:"[Cart Pos, Cart Vel, Pole Angle, Pole Vel]"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Action"}),": ",(0,i.jsx)(n.code,{children:"Left"})," or ",(0,i.jsx)(n.code,{children:"Right"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"code-the-random-agent",children:"Code: The Random Agent"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'import gymnasium as gym\n\n# 1. Create Environment\nenv = gym.make("CartPole-v1", render_mode="human")\n\n# 2. Reset\nobs, info = env.reset()\n\n# 3. Loop\nfor _ in range(100):\n    env.render()\n    \n    # Random Action\n    action = env.action_space.sample()\n    \n    # Step Physics\n    obs, reward, terminated, truncated, info = env.step(action)\n    \n    if terminated or truncated:\n        obs, info = env.reset()\n\nenv.close()\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Run it"}),": You should see a window pop up with a cart failing miserably to balance the pole."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"313-understanding-the-observation",children:"3.1.3 Understanding the Observation"}),"\n",(0,i.jsx)(n.p,{children:"Add this print statement inside the loop:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'print(f"Obs: {obs} | Reward: {reward}")\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Obs"}),": A numpy array of 4 floats."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Reward"}),": ",(0,i.jsx)(n.code,{children:"1.0"})," for every frame the pole stays up."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["In the next lab, we will replace the ",(0,i.jsx)(n.code,{children:"random"})," action with a ",(0,i.jsx)(n.code,{children:"learned"})," one."]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>l});var r=t(6540);const i={},a=r.createContext(i);function s(e){const n=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);